!function e(n,t,r){function s(u,c){if(!t[u]){if(!n[u]){var i="function"==typeof require&&require;if(!c&&i)return i(u,!0);if(o)return o(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var l=t[u]={exports:{}};n[u][0].call(l.exports,function(e){var t=n[u][1][e];return s(t?t:e)},l,l.exports,e,n,t,r)}return t[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)s(r[u]);return s}({1:[function(e,n,t){"use strict";var r=e("./retry.socket.js"),s=e("./queue/index.js"),o=e("./retry/index.js"),u={extendRapportInstance:function(e){e.constructWebsocket=function(n,t){var u=r(e.Websocket,n,t.protocols,t.connection);return u.setRetryer(o(t.reconnect)),u.setMessageQueue(s(t.reconnect)),u.connect()}}};"undefined"!=typeof window&&(window.RapportReconnect=u),"undefined"!=typeof n&&(n.exports=u)},{"./queue/index.js":2,"./retry.socket.js":4,"./retry/index.js":5}],2:[function(e,n,t){"use strict";var r=e("./simple.queue.js"),s=function(e){if(!e||!e.queueMessages)return null;var n={};if(e.queueMessages===!0?n.type="simple":"string"==typeof e.queueMessages?n.type=e.queueMessages:n=e.queueMessages,n.type&&"simple"!==n.type)throw new TypeError("Invalid message queue type: "+n.type);return r()};n.exports=s},{"./simple.queue.js":3}],3:[function(e,n,t){"use strict";var r=function(){var e={messages:[],push:function(n){e.messages.push(n)},purge:function(){e.messages=[]},flush:function(n){for(;e.messages.length>0;)n(e.messages.shift())}};return e};n.exports=r},{}],4:[function(e,n,t){"use strict";var r=function(e,n,t,r){var s={wsImplementation:e,url:n,protocols:t,connectionOptions:r,instance:null,handlers:{open:function(){},message:function(){},error:function(){},close:function(){}},retryer:null,messageQueue:null,connecting:!1,closed:!1,setRetryer:function(e){s.retryer=e},setMessageQueue:function(e){s.messageQueue=e},successfullyConnected:function(){s.connecting=!1,s.retryer&&s.retryer.reset(),s.messageQueue&&s.messageQueue.flush(s.send),s.handlers.open()},abort:function(e,n){s.connecting=!1,s.messageQueue&&s.messageQueue.purge(),s.handlers.close(e,n)},reconnect:function(e,n){return s.closed||1e3===e||!s.retryer?void s.abort(e,n):(s.connecting=!0,void s.retryer.attempt(s.connect,s.abort.bind(s,e,n)))},connect:function(){return s.connecting=!0,s.instance=new s.wsImplementation(s.url,s.protocols,s.connectionOptions),s.instance.on?(s.instance.on("open",s.successfullyConnected),s.instance.on("message",s.handlers.message),s.instance.on("error",s.handlers.error),s.instance.on("close",s.reconnect)):(s.instance.onopen=s.successfullyConnected,s.instance.onmessage=s.handlers.message,s.instance.onerror=s.handlers.error,s.instance.onclose=s.reconnect),s},removeAllListeners:function(){},on:function(e,n){s.handlers[e]=n},send:function(e){s.connecting?s.messageQueue&&s.messageQueue.push(e):s.instance.send(e)},close:function(e,n){s.closed=!0,s.retryer&&s.retryer.cancel(),s.messageQueue&&s.messageQueue.purge();try{s.instance.close(e,n)}catch(e){}}};return s};n.exports=r},{}],5:[function(e,n,t){"use strict";var r=e("./interval.retry.js"),s=function(e){if(!e)return null;var n={};if(e===!0?n.type="interval":"string"==typeof e?n.type=e:n=e,e.type&&"interval"!==e.type)throw new TypeError("Invalid reconnect type: "+n.type);return r(n)};n.exports=s},{"./interval.retry.js":6}],6:[function(e,n,t){"use strict";var r=function(e){var n={attempts:0,maxAttempts:e.maxAttempts||0,interval:e.interval||500,timeout:null,attempt:function(e,t){return n.maxAttempts&&n.attempts>=n.maxAttempts?void t():(n.attempts++,void(n.timeout=setTimeout(e,n.interval)))},reset:function(){n.attempts=0},cancel:function(){n.timeout&&clearTimeout(n.timeout)}};return n};n.exports=r},{}]},{},[1]);
